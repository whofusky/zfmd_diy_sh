
# mergeTbn30miDataFile说明

</br>
</br>

软件当前版本: v20.01.020

文档更新时间: 2023-03-29

作者    : fu.sky

</br>

------------------------------

版本变化历史记录:

> 2023-03-29 : 因河北尚义石井电场需求(同一文件输出到多个目标目录)
>              由 v20.01.020 升级到 v20.01.030    
>
> 2023-02-09 : 因河北尚义石井电场发现bug(不能删除多个结果文件夹过期文件)
>              由 v20.01.010 升级到 v20.01.020
>
> 2022-06-17 : 因河北尚义石井电场需求(输出多个文件)由 v20.01.000 升级到 v20.01.010
>
> 2021-03-17 : 初始版本 : v20.01.000

------------------------------

</br>


## 目录

+ 1. -------------------------[功能说明](#1-功能说明)
+ 2. -------------------------[格式要求](#2-格式要求)
  - 2.1 --------------------[1分钟数据源文件](#2_1-1分钟数据源文件)
  - 2.2 --------------------[生成的结果文件](#2_2-生成的结果文件)
+ 3. -------------------------[软件部署](#3-软件部署)
+ 4. -------------------------[软件目录结构说明](#4-软件目录结构说明)
+ 5. -------------------------[其他需要说明的情况](#5-其他需要说明的情况)
+ 6. -------------------------[文档变更历史记录](#6-文档变更历史记录)
+ 7. -------------------------[附配置文件样例](#7-附配置文件样例)

</br>

------------------------------

</br>


## 1 功能说明

简述: 根据已经生成的30个单风机1分钟数据文件生成一个文件文件


</br>

详细情况:    
  此程序根据配置文件cfg/cfg.cfg的实际配置值，再根据已经生成好的30个
1分钟数据文件（生成此文件不是此软件功能,由别的软件提供）合成一个包含30分钟数据
的单个文件提供给上传软件使用。


</br>


> 程序查找1分钟源数据文件和生成结果文件的逻辑如下:    
> 
>> 为了举例说明方便作如下假定:    
>>       假定1分钟文件名类似:genwnd_1_20210317_1330.cime    
>>       生成的结果文件名类似:JIMENHE_HT_20210317_1430.DJ
>       
>
>        (1) 如果程序运行时刻对应的分钟数值在「0-29之间（包括0和29）」
>            【1分钟源文件】查找规则:找前一小时30-59分钟对应的文件；    
>            【结果文件名】的时间小时值为前一小时,分钟值为30    
>
>            e.g:     
>                程序运行时刻为: 「2021-03-17 15:01:02」  
>                需要找的【1分钟数据文件】名为:
>                                genwnd_1_20210317_1430.cime  
>                              到genwnd_1_20210317_1459.cime 
>                              这30个文件   
>                【结果文件名】为: JIMENHE_HT_20210317_1430.DJ   
>
>        (2) 如果程序运行时刻对应的分钟数值在「30-59之间（包括30和59）」
>            【1分钟源文件】查找规则:找当前小时0-29分钟对应的文件；    
>            【结果文件名】的时间小时值为当前小时,分钟值为00       
>
>            e.g:     
>                程序运行时刻为: 「2021-03-17 15:31:30」      
>                需要找的【1分钟数据文件】名为:
>                                genwnd_1_20210317_1500.cime      
>                              到genwnd_1_20210317_1529.cime     
>                              这30个文件       
>                【结果文件名】为:JIMENHE_HT_20210317_1500.DJ       

>     说明:生成的目标文件名除时间之外，可以在配置文件中配置     

</br>


**『注意』**

```
  mergeTbn30miDataFile.sh 脚本程序支持两种方式运行:
  (1) 不带参数
      此种情况为程序自动根据当前系统时间按上面的寻找逻辑查找1分钟源文件并
      生成相应时间的上传文件
  (2) 输入时间参数
      此各情况则根据输入时间作为脚本的当前时间再按上面的寻找逻辑查找1分钟源
      文件并生成相应时间的上传文件
  第(1)种情况是脚本大多数的正常情况下状态；    
  第(2)种情况主要用于手动生成某个补传文件；     
  第(2)情况的时间格式为 YYYYMMDDHHMISS 或 YYYYMMDDHHMI      

  例如: 补传2023-03-02_14:30:02这个时间的文件则手动运行脚本格式如下
        ./mergeTbn30miDataFile.sh 20230302143002
        或者
        ./mergeTbn30miDataFile.sh 202303021430
```



</br>

 [返回目录](#目录)


</br>

------------------------------

</br>



## 2 格式要求

要用此软件合成30分钟文件，需要有如下格式要求，【否则不支持合成功能】    


</br>

###  2_1 1分钟数据源文件

文件名格式:

```
xxxxxxx_20210318_0958.xxxxxx  #其中"xxxx"可以任意，其中的数字代表年月日，小时分钟
例如文件名:genwnd_1_20230403_1559.cime
```

文件内容除了文件头和尾其他内容类似如下格式(其实脚本中只解析#开始并紧跟空格的行):


```
@	EC	PP_AVG	PQ_AVG	WS_AVG	SF_OGN	FAULT
#	0	35.861	2.123	9.856	15	16^17
@	EC	PPAVG	PQ_AVG	WS_AVG	SF_OGN	FAULT
#	1	15.369	21.230	8.624	45	16^17
@	EC	PPAVG	PQ_AVG	WS_AVG	SF_OGN	FAULT
#	2	15.369	6.369	9.856	44	16^17
```
    

『 ▧▧ 注意 ▧▧ 』：   

1.其中@行的字段名对脚本来说不重要，脚本不解析，脚本只解析#行    

2.文件格式中的每列代表的函义不能变，变了此脚本生成的逻辑就要更改了;    

3.文件列与列之间顺序不能调换，必须按上面示例的顺序存储;    

4.每一行的FAULT列可以有多列多列用空格隔开不影响脚本正常生成结果文件。    


</br>

### 2_2 生成的结果文件

```
  注意:

1. 从脚本的v20.01.010 开始可以配置生成多种文件(即:可以配置不同风机生成不同的文件名)
1. 从脚本的v20.01.030 开始可以配置同一种结果文件存放多个不同的目录    
```

文件名格式:

```
JIMENHE_HT_20210311_1430.DJ 

#JIMENHE:      风场名; 
#HT:           风机厂家编码;
#20210311_1430 年月日时分

#   文件名中的时间字段采用向前取时的方式，例如
#   风机2016年09月26日0点0分至0点29共三十分钟的单机运行数据，
#   其命名应为“JIMENHE_HT_20160926_0000.DJ”

```

文件内容类似如下格式:

```
<DANJI::JIMENHE DATE='2021-03-11'>
@INDEX ID TYPE TIME PWRAT PWRREACT SPD STATE FAULT
#1 1#FJ HT01 14:30 250.76 -156.00 4.67 2 '(0)'
#2 1#FJ HT01 14:31 103.62 -149.00 3.80 2 '(0)'
#3 1#FJ HT01 14:32 126.41 -319.00 3.86 2 '(0)'
...
#31 2#FJ HT01 14:30 251.87 -155.00 4.30 2 '(0)'
#32 2#FJ HT01 14:31 310.37 -150.00 5.93 2 '(0)'
#33 2#FJ HT01 14:32 232.59 -319.00 4.57 2 '(0)'
...
</DANJI::JIMENHE>

```

</br>


注意：     

> 1.结果文件的第一行内容如下部分可以通过配置定制:    
>> JIMENHE      
>> DATE=后的引号(单引号、双引号)        
>
> 2.第二行内容整行内容可在配置文件中定制         
>  
> 3.不能修改文件中每一列原来所代表的含义(每一列的顺序也是不可修改的)    
> 结果文件每一列的含义为: 序号、风机ID、风机型号、源数据生成时间、有功平均值、无功平均值、风速平均值、风机状态、风机故障代码    
>
> 3.结果文件内容的生成逻辑简单描述如下（此逻辑可以方便维护和研发人员判断是否可以根据源文件格式生成结果文件的格式）    
>
> (1). INDEX列只是一个顺序号递增的数字，脚本运行时自动顺序添加    
>
> (2). ID列是通过源文件的EC编码+1并配合配置文件的g_turbn_ID_suffix配置项的值生成    
>
> (3). TYPE列是通过源文件EC编码为下标配合配置文件的g_turbn_TTYPE[x]的值生成
>
> (4). TIME列是通过源文件名"xxxxxxx_20210318_0958.xxxxxx"中的0958所在的域生成
>
> (5). PWRAT PWRREACT SPD 直接取的源文件的PP_AVG  PQ_AVG  WS_AVG 列原样（顺序都不变）输出，但精度(保留小数位数)可以在配置文件的g_PP_scale等配置项配置
>
> (6). STATE列是通过源文件的SF_OGN列的值为下标配合配置文件的g_turbn_TSTATE[x]和g_default_TSTATE值生成
>
> (7). FAULT列是将源文件的多个列(如果一个列有多个值默认用^分隔,如果分隔符不是^可以通过配置文件的g_1mi_fixCnt_FaultJinChar配置项修改)合并成结果文件的FAULT列,结果文件不修改源文件的值只是把源文件中的多个值用()分隔，所有的值用单引号括起来    
>



</br>


 [返回目录](#目录)


</br>

------------------------------

</br>



## 3 软件部署

1. 确定生成1分钟数据文件的软件运行在哪个操作系统用户下，则此程序也部署在相同的用户下    

2. 将此软件包解压后（解压请在linux下进行）放在与公司常用软件目录；例如放在/zfmd/wpfs20目录下    

3. 在软件包下找到配置文件cfg/cfg.cfg，根据实际情况和配置文件注释说明进行配置(调试时设置OUT_LOG_LEVEL=${DEBUG})  

> 注意:     
> 1. 修改文件配置时需要仔细阅读配置文件中每一个配置项对应的注释说明，有的不需要配置的可以用默认值即可   
> 2. 配置文件中各配置项名称不能变（修改配置文件前把配置文件备份一下)    

4. 在软件包目录下打开终端执行 `chmod u+x *.sh `和 `chmod u+x manageCron` 并用命令`./mergeTbn30miDataFile.sh`    
   手动运行程序，查看配置文件中g_dst_result_dir项配置的目录下是否有正常结果文件生成     

5. 查看log目录下日志文件是否有ERROR字样的报错信息       

6. 在第4，5步确认正常后将此软件配置到crontab定时任务中去    

> 在脚本的同级目录下打开终端执行 ./manageCron  然后会出现类似如下的提示     

```
       
           [提示]:如果发现当前用户下已经有当前脚本的配置
                  但路径或定时频率不符合要求,需要先选择[2]
                  进行卸载然后再进行其他操作

           请输入如下数字，选择相应的操作：
                    [0].查看当前用户[fusky]所有cron设置
                    [1].安装脚本的cron设置
                    [2].卸载脚本的cron设置
                    [3].暂停脚本的cron设置
                    [4].重新启用脚本的cron设置
                    [5].退出，什么都不做
          你的选择是: 

```
> 根据提示操作即可：例如初装选择1即可 

7. 观察软件运行1小时左右，确认日志文件是否正常，确认生成的结果文件是否正常（前提是生成1分钟数据文件的软件在正常生成数据)    

8. 将配置文件中的日志输出等级为`OUT_LOG_LEVEL=${INFO}`  

9. 部署结束.    




</br>

 [返回目录](#目录)


</br>


------------------------------

</br>


## 4 软件目录结构说明


</br>

软件所在目录的结构和相关说明如下：


```
../merge_tbn_30miDataFile/       <----------- #程序所在目录（包)名
├── mergeTbn30miDataFile.sh     <----------- #运行脚本的名称
├── myDiyShFunction.sh          <----------- #脚本用到的一些函数文件
├── manageCron                  <----------- #在终端运行此程序来配置mergeTbn30miDataFile.sh的cron设置
├── version.txt                 <----------- #程序运行后此文件记录当前脚本的版本号
├── readme.md                   <----------- #MarkDown格式的说明文档
├── .tRecorded                  <----------- #用于记录当天已经生成文件（防止重复生成)
├── cfg/                         <----------- #程序配置文件目录
│   └── cfg.cfg                     <----------- #程序的配置文件
├── gen_tmp_srcfile             <----------- #程序自测用于生成数据源文件工具(在没有生成1分钟程序时方便测试用)
│   ├── gen.sh                      <----------- #自测试时生成文件脚本
│   └── result                      <----------- #gen.sh生成的结果文件目录
├── log/                         <----------- #软件运行日志目录
│   ├── cron.txt
│   └── mergeTbn30miDataFile_20210318.log  <-#软件运行日志(年月日根据实际运行时间变动)
├── result/                      <----------- #软件自测时的临时目录
├── result1/                     <----------- #软件自测时的临时目录
├── sample_output_file          <----------- #开发此需求时的样例文件目录
│   └── JIMENHE_HT_20210311_1430.DJ
│   └── SHIJING_SQ_20220505_0200.DJ
│   └── SHIJING_JF_20220505_0200.DJ
└── tmp/                         <----------- #软件运行时产生的临时文件目录
    ├── do/                      <----------- #软件运行时将1分钟源文件拷贝到此目录再处理
    │   ├── tmp/ <--- #软件运行时临时拷贝的处理数据源文件
    │   ├── genwnd_1_20210318_0958.cime <--- #软件运行时临时拷贝的处理数据源文件
    │   └── genwnd_1_20210318_0959.cime
    ├── tmp_fj_EC_9.bak             <------- #对某个风机EC处理的临时文件
    └── tmp_fj_EC_9.txt             <------- #对某个风机EC处理的临时文件

```



</br>

 [返回目录](#目录)


</br>

------------------------------

</br>



## 5 其他需要说明的情况

1. 配置文件中有配置过期则把相应过期文件删除的配置项，即使是配置成删除且有符合条件的文件需要删除，
程序不是立即执行删除，当前系统时间对应分钟数在15到25之间才执行删除操作（有此条件是以量避免影响程序的正常功能)

2. 此软件在生成30分钟结果文件过程中（即正在生成结果文件还没生成完毕，但有文件出现了），
结果文件的临时目录是tmp/do，当文件生成完毕后才对其进行mv操作，移动到最终的目标文件夹。
> 此举是为了避免其他处理结果文件的程序在文件没生成完毕就对其进行处理(而得到非想要的结果)。


</br>


## 6 文档变更历史记录

1.  2021-04-06: 对文档添加”5.其他需要说明的情况“中的第二条说明,并对文档进行目录结构化
1.  2022-06-17: 对文档进行v20.01.010相应版本的变化
1.  2023-02-09: 对v20.01.020进行说明(修改bug：有多个结果文件目录时,不能删除第1个之后的过程文件)
1.  2023-03-29 : 因河北尚义石井电场需求(同一文件输出到多个目标目录)由 v20.01.020 升级到 v20.01.030    


</br>

 [返回目录](#目录)



</br>

------------------------------------------------------------------------------

## 7 附配置文件样例

```shell

################################################################################
#
#                        『 ▧▧ 配置说明 ▧▧  』
#                          
#     1. 此配置文件中凡'#'号在一行中开头的行为注释行，不影响配置项
#     2. 所有配置项所用”号为英文半角状态下输入的引号
#     3. 配置项中的=号两边不能有空格
#     4. 所有的路径配置值不要在最后加/符号：
#          例如:配置/zfmd/wpfs20 此为某个路径值
#               不能配置成/zfmd/wpfs20/
#
#     5. 文件中经常会提到一个词"EC编号"解释如下:
#          (1) EC编号即为功能预测系统内部使用的一种风机编号
#          (2) EC编号从0开始到风机数量减1结束；
#              例如某电场有52台风机那么ec编号为0至51
#
################################################################################




#脚本的版本号:
#     2021-03-17 initial version  v20.01.000
#     2020-06-17 因河北尚义石井电场需求(输出多个文件)由 v20.01.000 
#                升级到 v20.01.010
#     2023-02-09 因河北尚义石井电场发现bug(不能删除多个结果文件夹过期文件) 
#                由 v20.01.010 升级到 v20.01.020
#     2023-03-29 因河北尚义石井电场需求(同一文件输出到多个目标目录)由 
#                v20.01.020 升级到 v20.01.030
g_version_no="v20.01.030"




################################################################################
#
#                  『 ▧▧ 日志输出控制 ▧▧  』
#
# 调试时     OUT_LOG_LEVEL=${DEBUG}
# 正常运行时 OUT_LOG_LEVEL=${INFO}
#
# g_log_delExpirFlag=0    
# 是否对过期日志文件进行删除0：不删除;1:删除
#
# g_log_delExpirDays=1    
# 如果g_log_delExpirFlag=1则对超期多少天的日志进行删除
#
################################################################################

NOOUT=0 ; levelName[0]="NOOUT";
ERROR=1 ; levelName[1]="ERROR";
INFO=2  ; levelName[2]="INFO" ;
DEBUG=3 ; levelName[3]="DEBUG";

#调试时: 
#       设置成${DEBUG} 
#正常运行时:
#       设置成${INFO} 
#
#OUT_LOG_LEVEL=${INFO}
OUT_LOG_LEVEL=${DEBUG}

g_log_delExpirFlag=1

g_log_delExpirDays=1




################################################################################
#
#            『 ▧▧ 1分钟风机数据源文件相关配置 ▧▧  』
#
#配置举例:
#    如源文件名称为: /zfmd/wpfs20/tmp/genwnd_1_20210315_0331.cime 
#    则配置如下:
#
# g_1mi_src_dir="/zfmd/wpfs20/tmp"   #文件路径
# g_1mi_filePre_domain="genwnd_1"    #文件名前缀
# g_1mi_suffix_domian=".cime"        #文件名后缀
# g_1mi_joiner_char="_"              #文件名连接符
# g_1mi_basicCondition_num=30        #至少需要多少个1分钟文件才进行处理少于此
#                                     数不进行30分钟文件合成
# g_1mi_delExpirFlag=0               #是否对g_1mi_src_dir目录超期的文件进行删
#                                     除0：不删除;1:删除
# g_1mi_delExpirDays=1               #如果g_1mi_delExpirFlag=1则对超期多少天的
#                                     文件进行删除
# g_1mi_fixCnt_FaultJinChar=","      #1分钟源文件字段FAULT，有多个值时的分隔符
#
################################################################################
# 
#文件路径
g_1mi_src_dir="/home/fusky/tmp/fs20/merge_tbn_30miDataFile/gen_tmp_srcfile/result"   

#文件名前缀
g_1mi_filePre_domain="genwnd_1"

#文件名后缀
g_1mi_suffix_domian=".cime"

#文件名连接符
g_1mi_joiner_char="_"

#是否对源目录中超期的文件进行删除:(单位:天)
# 0：不删除;1:删除
g_1mi_delExpirFlag=1

#如果对超期文件进行删除，设置超期天数
g_1mi_delExpirDays=1

#1分钟源文件字段FAULT，有多个值时的分隔符
g_1mi_fixCnt_FaultJinChar="^"  

#至少需要多少个1分钟文件才进行处理
g_1mi_basicCondition_num=30

#是否补充缺失的文件:
#    0 不补充，
#    1 补充 (补充发生的条件是文件数少于
#      g_1mi_basicCondition_num时则自动
#      用最近时间点的文件替代
g_supp_miss_file=1      #建议配置成1 

#是否补充某一风机缺少时间点的数据:
#    0 不补充，
#    1 补充
g_supp_miss_item=1      #建议配置成1 




################################################################################
#
#                『 ▧▧ 上传文件名定义 ▧▧  』
#
#根据现场实际情况进行配置，
#    如果只有1种类型的上传文件则只需要配置1组[]值即可
#    如果2种类型的上传文件则需要配置2组[]值
#    但组[]的下标需要从0开始，多组时下标值需要连续
#
#例如:

#   【只需要:JIMENHE_HT_20210311_1430.DJ 则配置如下】
#
# g_upfile_frmName_domain[0]="JIMENHE"   #上传文件名中的"风电场调度名称全拼"
# g_upfile_fanCode_domain[0]="HT"        #上传文件名中的"风机厂家代码"
# g_upfile_suffix_domain[0]=".DJ"        #上传文件名中的"后缀"
# g_upfile_joiner_char[0]="_"            #上传文件名中的"连接符"
#
#   【如需要两种类型的上传文件形如:】
#      SHIJING_JF_20210311_1430.DJ 和
#      SHIJING_SQ_20210311_1430.DJ 则配置如下
#
# g_upfile_frmName_domain[0]="SHIJING"   
# g_upfile_fanCode_domain[0]="JF"       
# g_upfile_suffix_domain[0]=".DJ"      
# g_upfile_joiner_char[0]="_"         
# 
# g_upfile_frmName_domain[1]="SHIJING"   
# g_upfile_fanCode_domain[1]="SQ"       
# g_upfile_suffix_domain[1]=".DJ"      
# g_upfile_joiner_char[1]="_"         
#
################################################################################
#

# 【请根据现场实际的情况对[]配置组进行添加或删除设置】

#文件1的文件名配置
g_upfile_frmName_domain[0]="SHIJING"   
g_upfile_fanCode_domain[0]="JF"       
g_upfile_suffix_domain[0]=".DJ"      
g_upfile_joiner_char[0]="_"         

#文件2的文件名配置
g_upfile_frmName_domain[1]="SHIJING"   
g_upfile_fanCode_domain[1]="SQ"       
g_upfile_suffix_domain[1]=".DJ"      
g_upfile_joiner_char[1]="_"         


#风机数量:
g_turbn_num=52           

#定义每一种上传文件包括的风机EC编号
#注意:
#    EC编号从0开始即风机1对应EC 0,
#    多个编号用英文半角逗号(,)分隔;
#    连续号用-连接
#
g_file_ec[0]="0-32"  #文件0中包括的EC号
g_file_ec[1]="33-52" #文件1中包括的EC号




################################################################################
#
#                 『 ▧▧ 上传文件路径配置 ▧▧  』
#
#注意:
#     此处的路径应该与上面的文件名相对应，即如果上面配置有n种文件名则此部分
#     应该配置n个g_dst_result_dir
#
# g_dst_result_dir[x]="/zfmd/wpfs20/tmp"     
#结果文件的目录配置:
#    同时生成多种文件就应该配置多少个目录，下标x从0开始，
#    同一种文件可配置多个目录，用|分隔
#
# g_dst_delExpirFlag=0               
#是否对超期的结果文件进行删除
#    0：不删除;
#    1:删除
#
# g_dst_delExpirDays=1               
#对超期天数进行设置:(单位为:天)
#
################################################################################
#

# 【请根据现场实际的情况对[]配置组进行添加或删除设置】

#一种文件对应一种g_dst_result_dir，
#   例如同时生成2个文件则配置两个g_dst_result_dir

#第1种文件的目录
g_dst_result_dir[0]="/home/fusky/tmp/fs20/merge_tbn_30miDataFile/result|/home/fusky/tmp/1" 

#第2种文件的目录
g_dst_result_dir[1]="/home/fusky/tmp/fs20/merge_tbn_30miDataFile/result1|/home/fusky/tmp/2" 


#是否对超期的结果文件进行删除
#    0：不删除; 1:删除
g_dst_delExpirFlag=1

#对超期天数进行设置:(单位为:天)
g_dst_delExpirDays=1




################################################################################
#
#                『 ▧▧ 上传文件内容配置 ▧▧  』
#
#例如,文件内容如下(不包括行首的#号和#号后的空格):
#
#  <DANJI::JIMENHE DATE='2021-03-11'>
#  @INDEX ID TYPE TIME PWRAT PWRREACT SPD STATE FAULT
#  #1 1#FJ HT01 14:30 250.76 -156.00 4.67 2 '(0)' 
#  #2 2#FJ HT01 14:31 103.62 -149.00 3.80 2 '(0)'
#  ...
#  </DANJI::JIMENHE>
#
#则定义如下配置项:
#
# g_upfile_fixCnt_frmName="JIMENHE"   
# 文件内容中的"风电场名称编码"
#
# g_upfile_Head_TIM_QMARKS            
# 文件头<DANJI>中日期的引号定义:单引号定义为"'",双引号定义值为'"'
#
# g_upfile_fixCnt_itemH="@INDEX ID TYPE TIME PWRAT PWRREACT SPD STATE FAULT"   
# 文件内容中的"条目标头"
#
# g_turbn_exception_ec
#   配置不需要生成结果文件的风机EC编号；
#   可以为空，多个编号用英文半角逗号(,)分隔;连续号用-连接:
#      例如:
#      g_turbn_exception_ec=""  或 
#      g_turbn_exception_ec="0,4,20" 或
#      g_turbn_exception_ec="0,3,20-30"
#
################################################################################

# 文件内容中的"风电场名称编码"
g_upfile_fixCnt_frmName="SHIJING"                                            

# 文件头<DANJI>中日期的引号定义:单引号定义为"'",双引号定义值为'"'
g_upfile_Head_TIM_QMARKS='"'

# 文件内容中的"条目标头"
g_upfile_fixCnt_itemH="@ INDEX ID TYPE TIME PWR_AT PWRREACT SPD STATE FAULT"   

#配置不需要生成结果文件的风机EC编号；
# 可以为空，多个编号用英文半角逗号(,)分隔;连续号用-连接:
g_turbn_exception_ec=""  

#风机编号（1#FJ）中数字后固定的后缀配置
#   即生成的上传文件第2列内容(除数字之外的内容)
g_turbn_ID_suffix="#FJ"  

#文件内容各字段精度定义
g_PP_scale=1             #有功字段精度定义（即小数点位数定义)
g_PQ_scale=1             #无功字段精度定义（即小数点位数定义)
g_WS_scale=2             #风速字段精度定义（即小数点位数定义)
g_PP_divisor=1           #有功字段除法因子数（如将接到的数缩小100则配置100，扩大10倍则配置0.1)
g_PQ_divisor=1           #无功字段除法因子数（如将接到的数缩小100则配置100，扩大10倍则配置0.1)
g_WS_divisor=1           #风速字段除法因子数（如将接到的数缩小100则配置100，扩大10倍则配置0.1)




################################################################################
#
#                 『 ▧▧ 上传文件中风机型号配置 ▧▧  』
#
#其中配置项下标为风机的EC编号(注意EC编号从0开始)
#
#例如:
#   g_turbn_TTYPE[9]="HT03"   
#   代表EC编号为9的风机类型为HT03
#
################################################################################

#风机型号的默认值：
#   即生成文件中TYPE列的默认值
#   可以理解成上传文件中风机型号最多的一种型号
g_default_TTYPE="JF03"   

#如果不是上面默认型号中风机则需要用下标的形式把所有值都配置出来
#  例如:有风机EC为0,3,7的型号与默认型号不同则需要配置
#        g_turbn_TTYPE[0],g_turbn_TTYPE[3],g_turbn_TTYPE[7]
#
# 【请根据现场实际的情况对[]配置进行添加或删除设置,并对值进行修改】

g_turbn_TTYPE[33]="SQ01" ; g_turbn_TTYPE[34]="SQ01" 
g_turbn_TTYPE[35]="SQ01" ; g_turbn_TTYPE[36]="SQ01" 
g_turbn_TTYPE[37]="SQ01" ; g_turbn_TTYPE[38]="SQ01" 
g_turbn_TTYPE[39]="SQ01" ; g_turbn_TTYPE[40]="SQ01" 
g_turbn_TTYPE[41]="SQ01" ; g_turbn_TTYPE[42]="SQ01" 
g_turbn_TTYPE[43]="SQ01" ; g_turbn_TTYPE[44]="SQ01" 
g_turbn_TTYPE[45]="SQ01" ; g_turbn_TTYPE[46]="SQ01" 
g_turbn_TTYPE[47]="SQ01" ; g_turbn_TTYPE[48]="SQ01" 
g_turbn_TTYPE[49]="SQ01" ; g_turbn_TTYPE[50]="SQ01" 
g_turbn_TTYPE[51]="SQ01" ; g_turbn_TTYPE[52]="SQ01"




################################################################################
#
#                       『 ▧▧ 风机状态转换的配置 ▧▧  』
#
#此部分的配置的背景是:
#   1分钟数据文件中的风机状态 与 上传文件要求的状态
#   一般都不相同需要配置转换关系

#
#g_STATE_maxValue=128 
#配置1分钟原文件中出现在状态列可能出现的所有值中最大的值(注意不是状态的个数)
#
#g_default_TSTATE=1    
#风机状态的默认状值即上传文件中STATE列的默认值(
#可以理解成此值配置上传文件中最常见的状态值)
#
#g_turbn_TSTATE[x]=2 
#其中x为1分钟文件中状态值，
#等号右边配置的是对应转的后的值(调度要求的状态值)
#
################################################################################

#配置1分钟原文件中出现在状态列可能出现的所有值中最大的值(注意不是状态的个数)
g_STATE_maxValue=128  

#风机状态的默认状值即上传文件中STATE列的默认值(可以
#理解成配置上传文件中最常见的状态值)
g_default_TSTATE=1    

#不在以上的默认值g_default_TSTATE的状态需要
#   以1分钟文件中原始状态值为[]下标
#   等号后的值为转换后的上传状态
#   形式全配置出来
#
#   【注下面的配置只是例子,在实际的配置中删除如下配置并以现场情况为准】
#
g_turbn_TSTATE[0]=0 ; g_turbn_TSTATE[1]=3 ;g_turbn_TSTATE[2]=3 ; 
g_turbn_TSTATE[3]=0 ; g_turbn_TSTATE[4]=0 ;g_turbn_TSTATE[5]=0 ; 
g_turbn_TSTATE[6]=0 ; g_turbn_TSTATE[7]=0 ;g_turbn_TSTATE[8]=1 ; 
g_turbn_TSTATE[10]=0; g_turbn_TSTATE[11]=2;g_turbn_TSTATE[12]=0;
g_turbn_TSTATE[13]=0; g_turbn_TSTATE[14]=0;g_turbn_TSTATE[20]=3;
g_turbn_TSTATE[40]=3 ;g_turbn_TSTATE[60]=0;g_turbn_TSTATE[80]=0 ;
g_turbn_TSTATE[100]=1;g_turbn_TSTATE[120]=3 ;  




################################################################################
#
#                         『 ▧▧  全局临时变量 ▧▧  』
#
# 【此部分的配置不需要修改】
#
#g_file_SerialNo[0]=0 
#用于临时记录结果文件数据序号，值默认配置为0即可
#
#g_file_nums=0 
#用于临时记录同时应该生成文件数量，值默认配置为0即可
#
################################################################################
#

#  【以下配置不需要修改】
g_file_SerialNo[0]=0
g_file_nums=0




```

</br>

 [返回目录](#目录)


</br>


------------------------------

</br>

